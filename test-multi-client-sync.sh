#!/bin/bash

echo "ğŸ”„ Test de synchronisation du timer multi-clients"
echo "================================================"

echo ""
echo "ğŸ“‹ Instructions de test :"
echo "1. Ouvrir 4 onglets dans votre navigateur :"
echo "   - Onglet 1 : http://localhost:4200/presentation (MaÃ®tre du jeu)"
echo "   - Onglet 2 : http://localhost:4200/login (Joueur 1)"
echo "   - Onglet 3 : http://localhost:4200/login (Joueur 2)" 
echo "   - Onglet 4 : http://localhost:4200/login (Joueur 3)"

echo ""
echo "2. S'inscrire comme joueurs :"
echo "   - Inscrire 'Joueur1' dans l'onglet 2"
echo "   - Inscrire 'Joueur2' dans l'onglet 3"
echo "   - Inscrire 'Joueur3' dans l'onglet 4"
echo "   - Tous seront redirigÃ©s vers /waiting"

echo ""
echo "3. DÃ©marrer le quiz :"
echo "   - Dans l'onglet 1 (prÃ©sentation), cliquer 'Commencer le Quiz'"
echo "   - Puis 'DÃ©marrer la premiÃ¨re question'"
echo "   - Tous les joueurs passeront sur /quiz"

echo ""
echo "ğŸ” Points Ã  vÃ©rifier ABSOLUMENT :"
echo "   âœ… Tous les timers doivent afficher EXACTEMENT le mÃªme temps"
echo "   âœ… Tous les timers doivent dÃ©compter ensemble (pas de dÃ©calage)"
echo "   âœ… Le timer de la prÃ©sentation doit Ãªtre identique aux joueurs"
echo "   âœ… Pas de 'sauts' ou 'bonds' dans les timers"

echo ""
echo "ğŸ“Š Dans la console du navigateur, vÃ©rifiez les logs :"
echo "   - Recherchez 'ğŸ• Timer sync SERVER:' pour voir la synchronisation"
echo "   - Recherchez 'â±ï¸  Timer sync:' cÃ´tÃ© serveur"
echo "   - Les temps doivent Ãªtre identiques pour tous les clients"

echo ""
echo "ğŸ› Si les timers ne sont PAS synchronisÃ©s :"
echo "   - Notez la diffÃ©rence en secondes"
echo "   - VÃ©rifiez les logs de la console"
echo "   - Testez en rafraÃ®chissant les pages joueurs"

echo ""
echo "ğŸ’¡ AmÃ©liorations apportÃ©es :"
echo "   - Le serveur calcule le temps restant (pas les clients)"
echo "   - Synchronisation toutes les 500ms (au lieu de 1s)"  
echo "   - Tick local uniquement pour la fluiditÃ© visuelle"
echo "   - Source unique de vÃ©ritÃ© : le serveur"